<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>User Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .Main-btn {
            margin: 20px 50px;
            padding: 10px 20px;
            border-radius: 10px;
            background-color: aqua;
            font-weight: bold;
            border: none;
        }

        .result {
            margin: 30px 50px;
        }
    </style>
</head>

<body onload="renderUsers()">

    <!-- Button to open modal -->
    <button class="Main-btn" data-bs-toggle="modal" data-bs-target="#userModal">Open Form</button>

    <!-- Modal -->
    <div class="modal fade" id="userModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title">User Form</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <div class="mb-2">
                        <label>Name</label>
                        <input type="text" id="name" class="form-control" />
                    </div>
                    <div class="mb-2">
                        <label>Age</label>
                        <input type="text" id="age" class="form-control" />
                    </div>
                    <div class="mb-2">
                        <label>Gender</label>
                        <input type="text" id="gender" class="form-control" />
                    </div>
                    <div class="mb-2">
                        <label>Email</label>
                        <input type="text" id="email" class="form-control" />
                    </div>
                    <div class="mb-2">
                        <label>Mobile</label>
                        <input type="text" id="mobile" class="form-control" />
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn btn-primary" data-bs-dismiss="modal" onclick="submitForm()">Submit</button>
                </div>

            </div>
        </div>
    </div>

    <!-- Display users -->
    <div class="result"></div>

    <!-- Script -->
    <script>
        function submitForm() {
            const name = document.getElementById('name').value;
            const age = document.getElementById('age').value;
            const gender = document.getElementById('gender').value;
            const email = document.getElementById('email').value;
            const mobile = document.getElementById('mobile').value;

            const newUser = {
                Name: name,
                Age: age,
                Gender: gender,
                Email: email,
                Mobile: mobile
            };

            // Safely parse localStorage and ensure it's an array
            let users = [];
            try {
                const existing = JSON.parse(localStorage.getItem("Userss"));
                if (Array.isArray(existing)) {
                    users = existing;
                }
            } catch (e) {
                console.warn("Corrupt or missing localStorage, resetting.");
            }

            users.push(newUser);
            localStorage.setItem("Userss", JSON.stringify(users));
            renderUsers();
        }

        function renderUsers() {
            const resultDiv = document.querySelector(".result");
            let users = [];

            try {
                const stored = JSON.parse(localStorage.getItem("Userss"));
                if (Array.isArray(stored)) {
                    users = stored;
                }
            } catch (e) {
                users = [];
            }

            resultDiv.innerHTML = ''; // Clear previous output

            users.forEach((user, index) => {
                resultDiv.innerHTML += `
          <div class="card mb-3 p-3">
            <h5>User ${index + 1}</h5>
            <p><strong>Name:</strong> ${user.Name}</p>
            <p><strong>Age:</strong> ${user.Age}</p>
            <p><strong>Gender:</strong> ${user.Gender}</p>
            <p><strong>Email:</strong> ${user.Email}</p>
            <p><strong>Mobile:</strong> ${user.Mobile}</p>
          </div>
        `;
            });
        }
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>